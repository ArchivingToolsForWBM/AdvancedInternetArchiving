<html>
	<head>
		<style>
			html {
			background-color: black;
			color: white;
			font-family: sans-serif;
			}
			
			table, th, td {
			border: 1px solid white;
			border-collapse: collapse;
			}
			
			span.NoLineBreak {
				white-space: nowrap;
			}
		</style>
	</head>
<body>
<p>This javascript tool clears out a given list (text form), keeping the original order of items first appearing on the list. It removes duplicates and blank lines (or lines with just spaces, tabs, or any whitespace characters). This is useful
for setting up a list of URLs to archive.</p>
<textarea cols="100" rows="30" id="ListOfItems" oninput="ClearStatistic()"></textarea><br>
Duplicate list sort:<br>
<label><input type="radio" onchange="CleanList()" id="Sort_None" name="SortSetting_DuplicateList" checked>Keep original order based on submission</label><br>
<label><input type="radio" onchange="CleanList()" id="Sort_Alphabetically" name="SortSetting_DuplicateList">Sort alphabetically</label> <label><input type="radio" onchange="CleanList()" id="Sort_Alphabetically_Inverse" name="SortSetting_DuplicateList">Inverse</label><br>
<label><input type="radio" onchange="CleanList()" id="Sort_NumberOfDups" name="SortSetting_DuplicateList">Sort based on how many duplicates</label> <label><input type="radio" onchange="CleanList()" id="Sort_NumberOfDups_Inverse" name="SortSetting_DuplicateList">Inverse</label><br>
<button onclick="CleanList()">Submit</button><button onclick="Clear()">Clear</button><br>
<hr>
<span id="Statistic"></span><br><br>

<textarea readonly cols="100" rows="30" id="CleanedListOutput"></textarea><br>

<span id="DuplicateList"></span>

<script>
	function Clear() {
		document.getElementById("ListOfItems").value = ""
		document.getElementById("Statistic").innerHTML = ""
		document.getElementById("DuplicateList").innerHTML = ""
		document.getElementById("CleanedListOutput").innerHTML = ""
		document.getElementById("Sort_None").checked = true
	}
	function ClearStatistic() {
		document.getElementById("Statistic").innerHTML = ""
		document.getElementById("DuplicateList").innerHTML = ""
	}
	function CleanList() {
		let Statistic = ""
		let InputList = (document.getElementById("ListOfItems").value).split('\n') //Each line = each element in array
		//Clean the list
			if (document.getElementById("ListOfItems").value != "") {
				let OriginalListNumberOfItems = InputList.length //Get number of items before the cleaning
				let OutputList = RemoveBlankOrSpacesEntry(RemoveItemsInTableFaggedAsDuplicates(ConvertURLListToTableFlaggingDuplicates(InputList))) //Get the cleaned list
				let CleanedListNumberOfItems = OutputList.length //Get number of items after the cleaning
				let OutputString = "" //Reset the string should another data is entered/
				let Index = 0
				//Format the output so each element in the array is each line
					while (Index < OutputList.length) {
						OutputString += OutputList[Index]
						if (Index != OutputList.length - 1) {
							OutputString += "\n"
						}
						Index++
					}
				//Process output
					document.getElementById("CleanedListOutput").value = OutputString
					Statistic += "<kbd>" 
					if ((OriginalListNumberOfItems - CleanedListNumberOfItems) == 0) {
						Statistic += "No spaces or duplicates found."
					} else {
						Statistic += "Total number of items cleaned out: " + (BigInt(OriginalListNumberOfItems - CleanedListNumberOfItems)).toString(10)
					}
					Statistic += "</kbd>"
			} else {
				Statistic += "<kbd>List is empty.</kbd>"
			}
			//Write to HTML
				document.getElementById("Statistic").innerHTML = Statistic
		
		//List the duplicates
			let HTMLDuplicateList = ""
			let DuplicateDataTable = CountDuplicates(RemoveBlankOrSpacesEntry(InputList))
			//Sort if user specifies it.
				if (document.getElementById("Sort_Alphabetically").checked == true) {
					DuplicateDataTable = DuplicateDataTable.sort(SortDupsBy_ItemsName)
				} else if (document.getElementById("Sort_Alphabetically_Inverse").checked == true) {
					DuplicateDataTable = DuplicateDataTable.sort(SortDupsBy_ItemsName_rev)
				} else if (document.getElementById("Sort_NumberOfDups").checked == true) {
					DuplicateDataTable = DuplicateDataTable.sort(SortDupsBy_Dups)
				} else if (document.getElementById("Sort_NumberOfDups_Inverse").checked == true) {
					DuplicateDataTable = DuplicateDataTable.sort(SortDupsBy_Dups_rev)
				}
			
			if (DuplicateDataTable.length != 0) {
				HTMLDuplicateList += "<kbd>Number of unique items that were duplicates: " + BigInt(DuplicateDataTable.length).toString(10) +"</kbd>"
				HTMLDuplicateList += "<table>"
				HTMLDuplicateList += "<tr><th>item</th><th>Number of duplicates</th></tr>"
				for (let Index = 0; Index < DuplicateDataTable.length; Index++) {
					HTMLDuplicateList += "<tr>"
					HTMLDuplicateList += "<td><kbd>" + escapeHTMLChars(DuplicateDataTable[Index][0]) + "</kbd></td>"
					HTMLDuplicateList += "<td><kbd>" + BigInt(DuplicateDataTable[Index][1]).toString(10) + "</kbd></td>"
					HTMLDuplicateList += "</tr>"
				}
				HTMLDuplicateList += "</table>"
			}
			document.getElementById("DuplicateList").innerHTML = HTMLDuplicateList
	}
	function ConvertURLListToTableFlaggingDuplicates(ArrayList) {
		//This returns a 2D array: [[URL, DuplicateFlag], [URL, DuplicateFlag]]
		//-URL is the list of stuff (primarily URLs), assuming this do not have any sub-arrays within.
		//-DuplicateFlag is flagged false when no duplicates exists, otherwise if the second
		// or later items also exist, they themselves are flagged as true
		let index1 = 0
		let index2 = 0
		let OutputTableDuplicateFlags = new Array(ArrayList.length)
		for (index1 = 0; index1 < ArrayList.length; index1++) {
			OutputTableDuplicateFlags[index1] = Array(ArrayList[index1], false)
		}
		index1 = 0
		for (index1 = 0; index1 < ArrayList.length; index1++) {
			for (index2 = index1 + 1; index2 < ArrayList.length; index2++) {
				if (ArrayList[index1] == ArrayList[index2]) {
					OutputTableDuplicateFlags[index2][1] = true
				}
			}
		}
		return OutputTableDuplicateFlags
	}
	function RemoveItemsInTableFaggedAsDuplicates(TableFlaggingDups) {
		//Extracts whatever outputted by ConvertURLListToTableFlaggingDuplicates
		//that aren't duplicates, without gaps.
		let index1 = 0
		let OutputArray = new Array()
		for (index1 = 0; index1 < TableFlaggingDups.length; index1++) {
			if (TableFlaggingDups[index1][1] == false) {
				OutputArray.push(TableFlaggingDups[index1][0])
			}
		}
		return OutputArray
	}
	function RemoveBlankOrSpacesEntry(InputArray) {
		let OutputArray = new Array()
		let index1 = 0
		for (index1 = 0; index1 < InputArray.length; index1++) {
			if ((/^(\s*)$|^()$/).test(InputArray[index1]) == false) {
				OutputArray.push(InputArray[index1])
			}
		}
		return OutputArray
	}
	function CountDuplicates(InputArray) {
		//This array will list items that have a duplicates.
		//InputArray[Index][0] Is the item
		//InputArray[Index][1] Is how many duplicates. Will be -1 if that item is a duplicate not being the first one.
		
		//Returns an array with only items that existed at least twice, in which that list has no duplicates:
		//OutputDuplicateList[Index][0] = The item
		//OutputDuplicateList[Index][1] = number of duplicates, should be 1 or more.
		let ArrayWithDupCount = new Array()
		for (let Index = 0; Index < InputArray.length; Index++) {
			ArrayWithDupCount.push([InputArray[Index], 0])
		}
		
		for (Index1 = 0; Index1 < ArrayWithDupCount.length; Index1++) {
			if (ArrayWithDupCount[Index1][1] != -1) {
				for (let Index2 = Index1 + 1; Index2 < ArrayWithDupCount.length; Index2++) {
					if ((ArrayWithDupCount[Index1][0] == ArrayWithDupCount[Index2][0])&&(ArrayWithDupCount[Index2][1] != -1)) {
						ArrayWithDupCount[Index1][1]++
						ArrayWithDupCount[Index2][1] = -1
					}
				}
			}
		}
		let OutputDuplicateList = new Array()
		for (Index = 0; Index < ArrayWithDupCount.length; Index++) {
			if (ArrayWithDupCount[Index][1] >= 1) {
				OutputDuplicateList.push(ArrayWithDupCount[Index])
			}
		}
		return OutputDuplicateList
	}
	function escapeHTMLChars(string) {
		//Should the user's input contains "<", ">", and "&", prevent the innerHTML from treating these as HTML tags/escapes
			string = string.replaceAll("&", "&amp;") //This must be done first, to avoid replacing already-replaced symbol's ampersand character.
			string = string.replaceAll("<", "&lt;")
			string = string.replaceAll(">", "&gt;")
			return string
	}
	function SortDupsBy_ItemsName(a, b) {
		if (a[0] === b[0]) {
			return 0;
		} else {
			return (a[1] < b[1]) ? -1 : 1;
		}
	}
	function SortDupsBy_ItemsName_rev(a, b) {
		if (a[0] === b[0]) {
			return 0;
		} else {
			return (a[1] < b[1]) ? 1 : -1;
		}
	}
	function SortDupsBy_Dups(a, b) {
		if (a[1] === b[1]) {
			return 0;
		} else {
			return Number(a[1] - b[1])
		}
	}
	function SortDupsBy_Dups_rev(a, b) {
		if (a[1] === b[1]) {
			return 0;
		} else {
			return Number(b[1] - a[1])
		}
	}
</script>